import { HttpHeaders } from '@angular/common/http';
import { Component, OnInit } from '@angular/core';
//import { DetectService } from '../service/detect.service';
import { HttpClientService } from '../service/http-client.service';

@Component({
  selector: 'app-detect',
  templateUrl: './detect.component.html',
  styleUrls: ['./detect.component.scss']
})
export class DetectComponent implements OnInit {

  leafApicesValue:string=""
  leafBaceisValue:string=""
  leafMarginValue:string=""
  postdata=new Map <string,string>()
  jsonObject:any= {};
  jsonString:string=""
  datalist:any
  key:any
  constructor(private httpClient:HttpClientService) { 
    
  }

  ngOnInit(): void {
  }

   display(name:string,value:any) {
     console.log(name)
     if(name=='leaf_apicies')
     {
      this.leafApicesValue=value;
      console.log(this.leafApicesValue);
      }
     if(name=='leaf_margin')
     {
      this.leafMarginValue=value;
      console.log(this.leafMarginValue);
     }
     if(name=='leaf_bases')
       {
        this.leafBaceisValue=value;
        console.log(this.leafBaceisValue);
       }
     this.submit()
   }
   submit()
   {
       if(this.leafApicesValue!="")
       {
         this.postdata.set('leaf_apices',this.leafApicesValue)
         console.log(this.postdata)
       }
       if(this.leafBaceisValue!="")
       {
         this.postdata.set('leaf_bases',this.leafBaceisValue)
         console.log(this.postdata)
       }
       if(this.leafMarginValue!="")
       {
         this.postdata.set('leaf_margin',this.leafMarginValue)
         console.log(this.postdata)
       }
         
      this.postdata.forEach((value, key) => {  
       this.jsonObject[key] = value  
       });  
       this.jsonString=JSON.stringify(this.jsonObject);
       console.log(this.jsonString)
       
    
       this.httpClient.getfilename(this.jsonString).subscribe(
         res=>{
           //console.log(res)
           this.datalist=res;
           this.key=Object.keys(this.datalist);
           console.log(this.key)
           console.log("after key")
         }
       )
   }
    
  }

